<!DOCTYPE html>
<html>
<head>
  <title>Cart localStorage Inspector</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      max-width: 1200px;
      margin: 40px auto;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    h1 {
      color: #f97316;
      margin-bottom: 20px;
    }
    pre {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 20px;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 14px;
      line-height: 1.6;
    }
    .button {
      background: #f97316;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      margin-right: 10px;
    }
    .button:hover {
      background: #ea580c;
    }
    .button.danger {
      background: #dc2626;
    }
    .button.danger:hover {
      background: #b91c1c;
    }
    .section {
      margin: 20px 0;
      padding: 20px;
      background: #f9fafb;
      border-radius: 8px;
      border-left: 4px solid #f97316;
    }
    .issue {
      color: #dc2626;
      font-weight: 600;
    }
    .success {
      color: #059669;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîç Cart localStorage Inspector</h1>
    
    <div class="section">
      <h2>Instructions:</h2>
      <ol>
        <li>Open your browser at <strong>https://gharse.app</strong></li>
        <li>Open DevTools (F12 or Cmd+Option+I)</li>
        <li>Go to <strong>Console</strong> tab</li>
        <li>Copy and paste the script below</li>
      </ol>
    </div>

    <h2>üìã Script to Run in Browser Console:</h2>
    <pre>
// ============================================
// CART LOCALSTORAGE INSPECTOR
// ============================================

console.log('üîç INSPECTING CART DATA...\n');

// Get cart from localStorage
const cartData = localStorage.getItem('bantusKitchenCart');

if (!cartData) {
  console.log('‚ùå No cart found in localStorage');
} else {
  console.log('‚úÖ Cart found in localStorage\n');
  
  try {
    const cart = JSON.parse(cartData);
    
    console.log('üìä CART STRUCTURE:');
    console.log(JSON.stringify(cart, null, 2));
    
    console.log('\nüîç DETAILED ITEM ANALYSIS:');
    
    if (cart.items && cart.items.length > 0) {
      cart.items.forEach((item, index) => {
        console.log(`\n--- ITEM ${index + 1}: ${item.menuItem?.name || 'Unknown'} ---`);
        console.log(`Cart Item ID: ${item.id}`);
        console.log(`Menu Item ID: ${item.menuItem?.id}`);
        console.log(`Name: ${item.menuItem?.name}`);
        console.log(`Price: ${item.menuItem?.price} (type: ${typeof item.menuItem?.price})`);
        console.log(`Quantity: ${item.quantity}`);
        console.log(`Subtotal: ${item.subtotal} (type: ${typeof item.subtotal})`);
        console.log(`Is Subtotal NaN? ${isNaN(item.subtotal)}`);
        
        // Check for issues
        if (isNaN(item.subtotal)) {
          console.log(`‚ùå ISSUE FOUND: Subtotal is NaN!`);
          console.log(`   Expected: ${item.quantity} √ó ${item.menuItem?.price} = ${item.quantity * item.menuItem?.price}`);
        }
        
        if (typeof item.menuItem?.price !== 'number') {
          console.log(`‚ùå ISSUE FOUND: Price is not a number! (${typeof item.menuItem?.price})`);
        }
        
        if (item.menuItem?.price === 0) {
          console.log(`‚ö†Ô∏è  WARNING: Price is 0`);
        }
      });
      
      console.log('\nüí∞ CART TOTALS:');
      console.log(`Subtotal: ‚Çπ${cart.subtotal}`);
      console.log(`Tax: ‚Çπ${cart.tax}`);
      console.log(`Delivery Fee: ‚Çπ${cart.deliveryFee}`);
      console.log(`Discount: ‚Çπ${cart.discount}`);
      console.log(`Total: ‚Çπ${cart.total}`);
      
    } else {
      console.log('Cart is empty');
    }
    
  } catch (error) {
    console.error('‚ùå Failed to parse cart data:', error);
    console.log('Raw cart data:', cartData);
  }
}

console.log('\n' + '='.repeat(60));
console.log('üîß FIX OPTIONS:');
console.log('='.repeat(60));
console.log('\n1. Clear cart completely:');
console.log('   localStorage.removeItem("bantusKitchenCart");');
console.log('   location.reload();');
console.log('\n2. Wait for automatic price refresh (implemented in code)');
console.log('\n3. Re-add items to cart');
    </pre>

    <div class="section">
      <h2>üéØ What to Look For:</h2>
      <ul>
        <li><span class="issue">‚ùå "Subtotal is NaN"</span> - Price calculation failed</li>
        <li><span class="issue">‚ùå "Price is not a number"</span> - Price has wrong data type</li>
        <li><span class="issue">‚ö†Ô∏è "Price is 0"</span> - Old testing data</li>
        <li><span class="success">‚úÖ "Price: 299 (type: number)"</span> - Correct!</li>
      </ul>
    </div>

    <div class="section">
      <h2>üîß Quick Fix (in console):</h2>
      <pre>localStorage.removeItem('bantusKitchenCart');
location.reload();</pre>
      <p>This clears the cart and forces a fresh start with correct database prices.</p>
    </div>
  </div>
</body>
</html>

